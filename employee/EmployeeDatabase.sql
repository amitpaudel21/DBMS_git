CREATE DATABASE EMPLOYEE;
USE EMPLOYEE ;
CREATE TABLE DEPT (DEPTNO INT PRIMARY KEY, DNAME VARCHAR(50), DLOC VARCHAR(50));
CREATE TABLE PROJECT (PNO INT PRIMARY KEY, PNAME VARCHAR(50), PLOC VARCHAR(50));
CREATE TABLE EMPLOYEE (EMPNO INT PRIMARY KEY, ENAME VARCHAR(50), MGR_NO INT, HIREDATE DATE, SAL DECIMAL (10,2), DEPTNO INT, FOREIGN KEY (DEPTNO) REFERENCES DEPT(DEPTNO));
CREATE TABLE ASSIGNED_TO (EMPNO INT, PNO INT, JOB_ROLE VARCHAR(50), PRIMARY KEY (EMPNO, PNO), FOREIGN KEY (EMPNO) REFERENCES EMPLOYEE (EMPNO), FOREIGN KEY (PNO) REFERENCES PROJECT(PNO));
CREATE TABLE INCENTIVES(EMPNO INT, INCENTIVE_DATE DATE, INCENTIVE_AMOUNT DECIMAL(10,2), FOREIGN KEY(EMPNO) REFERENCES EMPLOYEE (EMPNO));

INSERT INTO DEPT VALUES (1,'Engineering','Bengaluru'),(2,'HR','Hyderabad'),(3,'Finance','Mysuru'),(4,'Marketing','Bengaluru'),(5,'Operations','Hyderabad'),(6,'IT','Mysuru');
INSERT INTO EMPLOYEE VALUES (101,'Ravi',100,'2020-03-10',55000,1),(102,'Anita',100,'2021-06-22',62000,2),(103,'Suresh',102,'2019-12-11',58000,3),(104,'Kiran',102,'2018-05-15',60000,4),(105,'Divya',NULL,'2015-01-01',90000,1),(106,'Manoj',102,'2017-07-18',75000,3);
INSERT INTO PROJECT VALUES (201,'AI Development','Bengaluru'),(202,'HR Portal','Hyderabad'),(203,'Budget Analysis','Mysuru'),(204,'Marketing Campaign','Bengaluru'),(205,'Supply Chain','Mysuru'),(206,'Cybersecurity','Hyderabad');
INSERT INTO INCENTIVES VALUES (101,'2023-06-01',5000.00),(102,'2023-09-10',3000.00),(103,'2023-08-20',4000.00),(104,'2023-09-10',2500.00),(105,'2023-10-05',NULL),(106,'2023-11-12',3500.00);
INSERT INTO ASSIGNED_TO VALUES (101,201,'Lead Developer'),(102,201,'Developer'),(103,202,'HR Analyst'),(104,202,'Coordinator'),(105,203,'Analyst'),(106,203,'Assistant');

SELECT DISTINCT A.EMPNO
FROM ASSIGNED_TO A 
JOIN PROJECT P ON A.PNO=P.PNO
WHERE P.PLOC IN ('Bengaluru','Hyderabad','Mysuru');

SELECT E.EMPNO
FROM EMPLOYEE E
LEFT JOIN INCENTIVES I ON E.EMPNO=I.EMPNO
WHERE I.EMPNO IS NULL;

SELECT E.ENAME,E.EMPNO,E.DEPTNO,A.JOB_ROLE,D.DLOC AS Department_Location, P.PLOC AS Project_Location
FROM EMPLOYEE E
JOIN DEPT D ON E.DEPTNO =D.DEPTNO
JOIN ASSIGNED_TO A ON E.EMPNO=A.EMPNO
JOIN PROJECT P ON A.PNO=P.PNO
WHERE D.DLOC=P.PLOC;